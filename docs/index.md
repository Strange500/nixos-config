# QGroget NixOS Configuration - Documentation Index

**Type:** Infrastructure as Code (Monolith)
**Primary Language:** Nix
**Architecture:** NixOS Flake Configuration
**Last Updated:** 2026-01-06

## Project Overview

This repository contains a comprehensive NixOS flake configuration managing multiple hosts: desktop workstations, a homelab server, gaming devices, and a Raspberry Pi. The configuration follows declarative, reproducible patterns with centralized secrets management via SOPS.

## Project Structure

This project is a **monolith** NixOS flake configuration with the following key areas:

### Host Categories

| Host | Type | Description |
|------|------|-------------|
| **Clovis** | Desktop | Primary desktop workstation with development tools |
| **Septimius** | Desktop | Secondary desktop workstation |
| **Clotaire** | Desktop | Additional desktop system |
| **Server** | Server | Homelab server running qgroget.com services |
| **Cube** | Gaming | Steam Deck-like gaming device with Jovian NixOS |
| **pi** | Embedded | Raspberry Pi (aarch64) |
| **installer** | ISO | Custom NixOS installer image |

### Tech Stack Summary

- **OS:** NixOS (unstable channel)
- **Configuration:** Nix Flakes
- **Desktop:** Hyprland / Niri window managers
- **Secrets:** SOPS + age encryption
- **Containers:** Podman with Quadlet
- **Reverse Proxy:** Traefik
- **SSO:** Authelia + LLDAP
- **Storage:** ZFS / BTRFS with impermanence

## Quick Reference

- **Entry Point:** `flake.nix`
- **Architecture Pattern:** Modular NixOS Configuration
- **Main Domain:** qgroget.com
- **Deployment:** `sudo nixos-rebuild switch --flake .#<hostname>`

## Generated Documentation

### Core Documentation

- [Project Overview](./project-overview.md) - Executive summary and high-level architecture
- [Source Tree Analysis](./source-tree-analysis.md) - Annotated directory structure
- [Architecture](./architecture.md) - Detailed technical architecture
- [Component Inventory](./component-inventory.md) - Catalog of all modules and services
- [Development Guide](./development-guide.md) - Local setup and development workflow

### Server Services

- [Server Services](./server-services.md) - Complete homelab service documentation

## Existing Documentation

- [README.md](../README.md) - Project introduction and quick start guide
- [.github/copilot-instructions.md](../.github/copilot-instructions.md) - AI assistant guidance

## Getting Started

### Prerequisites

- NixOS installed on target machine
- Nix with flakes enabled
- SOPS age key at `/var/lib/sops/age/keys.txt`

### Setup

```bash
# Clone the repository
git clone <repo-url> ~/nixos
cd ~/nixos

# Review available configurations
nix flake show

# Build and switch (replace Clovis with target hostname)
sudo nixos-rebuild switch --flake .#Clovis
```

### Run Tests

```bash
# Run Jellyfin integration test
nix build .#checks.x86_64-linux.jellyfinTest

# Run Jellyseerr test
nix build .#checks.x86_64-linux.jellyseerrTest
```

## For AI-Assisted Development

This documentation was generated specifically to enable AI agents to understand and extend this codebase.

### When Planning New Features:

**Desktop configuration changes:**
→ Reference: `architecture.md`, modules under `modules/desktop/` and `modules/apps/`

**Server/Homelab services:**
→ Reference: `server-services.md`, modules under `modules/server/`

**Adding new hosts:**
→ Reference: `architecture.md`, existing host configs in `hosts/`

**Secrets management:**
→ Reference: `architecture.md` security section, `secrets/secrets.yaml` (encrypted)

### Critical Patterns

1. Services register via `qgroget.services.<name>` option
2. Traefik routing auto-generated from service definitions
3. Impermanence manages persistent state declarations
4. Host-specific settings in `hosts/<hostname>/settings.nix`

---

_Documentation generated by BMAD Method `document-project` workflow_
